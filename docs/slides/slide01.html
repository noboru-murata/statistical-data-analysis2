<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Rによるデータ解析</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">Rによるデータ解析</h1>
</div>
<div class="talk-subtitle">
    <p>さまざまな多変量解析とR言語の使い方</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>

<section>
<section id="slide-org59122ed">
<h2 id="org59122ed">R言語の概要</h2>
<div class="outline-text-2" id="text-org59122ed">
</div>
</section>
<section id="slide-org2bd6fc9">
<h3 id="org2bd6fc9">R言語とは</h3>
<ul>
<li>統計計算のための言語と環境の総称</li>
<li>オープンソース・フリーソフトウェア</li>
<li>「パッケージ」を利用して容易に機能拡張が可能
<ul>
<li>パッケージの開発は非常に活発 (現在10000を越える)</li>
<li>最新の技術や方法が簡単に導入できることも多い</li>

</ul></li>
<li><a href="https://www.r-project.org/">https://www.r-project.org/</a> (プロジェクトのサイト)</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org0f1693c">
<h3 id="org0f1693c">RStudioとは</h3>
<ul>
<li>RStudio社が開発している統合開発環境(IDE)
<ul>
<li>R によるデータ解析や統計計算・パッケージ開発を支援</li>
<li>OSに依存しない対話型操作環境を提供</li>

</ul></li>
<li>本講義ではRStudioを用いて説明を行う</li>
<li><a href="https://www.rstudio.com/">https://www.rstudio.com/</a> (RStudio社のサイト)</li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org6b3ff4c">
<h3 id="org6b3ff4c">Rの得意分野</h3>
<ul>
<li><b>データの分類・集計・整理</b>
<ul>
<li>記述統計量 (基本・要約統計量) の計算</li>
<li>グラフによる視覚化</li>
<li>さまざまな統計分析 (多変量解析を含む)</li>

</ul></li>
<li>プログラムによる処理の自動化</li>
<li>擬似乱数による不確定性を含む現象の模擬 <br />
(確率的シミュレーション・モンテカルロ法)</li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org1cdad3f">
<h2 id="org1cdad3f">多変量解析</h2>
<div class="outline-text-2" id="text-org1cdad3f">
</div>
</section>
<section id="slide-org88dc976">
<h3 id="org88dc976">多変量解析とは</h3>
<ul>
<li>複数の変量からなるデータを分析する手法の総称
<ul>
<li>回帰分析: 複数の量を用いて注目する変数の値を説明する</li>
<li>主成分分析: 全体を説明する少数の特徴量を構成する</li>
<li>判別分析: 特徴量の違いでカテゴリ分けを行う</li>
<li>クラスタ分析: 特徴量の違いに着目してクラスタを構成する</li>
<li>時系列解析: 時間とともに変化する現象を記述する</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgf2a5643">
<h3 id="orgf2a5643">回帰分析の考え方</h3>
<ul>
<li>ある変数を別の変数によって説明・予測するための関係式(回帰式)を構成する
<ul>
<li>単回帰: 一つの変数で目的変数を説明する</li>
<li>重回帰: 複数の変数で目的変数を説明する</li>

</ul></li>
<li>分析の事例:
<ul>
<li>身長から体重を予測する式を作り，ある身長の人がある体重だったときに，それが普通かどうか判定する</li>
<li>築年数・駅からの距離・広さ・間取りで家賃を説明する式を作り，新規に家賃を設定する際に利用する</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgf09cb87">
<h3 id="orgf09cb87">単回帰の例 (<code>MASS::Animals</code>)</h3>
<table id="org8308892" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> 体重と脳の重さ</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">body [kg]</th>
<th scope="col" class="org-right">brain [g]</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Mountain beaver</td>
<td class="org-right">1.350</td>
<td class="org-right">8.1</td>
</tr>

<tr>
<td class="org-left">Cow</td>
<td class="org-right">465.000</td>
<td class="org-right">423.0</td>
</tr>

<tr>
<td class="org-left">Grey wolf</td>
<td class="org-right">36.330</td>
<td class="org-right">119.5</td>
</tr>

<tr>
<td class="org-left">Goat</td>
<td class="org-right">27.660</td>
<td class="org-right">115.0</td>
</tr>

<tr>
<td class="org-left">Guinea pig</td>
<td class="org-right">1.040</td>
<td class="org-right">5.5</td>
</tr>

<tr>
<td class="org-left">Dipliodocus</td>
<td class="org-right">11700.000</td>
<td class="org-right">50.0</td>
</tr>

<tr>
<td class="org-left">Asian elephant</td>
<td class="org-right">2547.000</td>
<td class="org-right">4603.0</td>
</tr>

<tr>
<td class="org-left">Donkey</td>
<td class="org-right">187.100</td>
<td class="org-right">419.0</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
</tr>
</tbody>
</table>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="org22ba1bc" class="figure">
<p><img src="./figs/r-brainbody05.png" alt="r-brainbody05.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 1: </span>体重と脳の重さの関係 (単回帰)</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgc96f2fe">
<h3 id="orgc96f2fe">重回帰の例 (<code>wine.csv</code>)</h3>
<table id="org325dfbe" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 2:</span> ワインの価格と生産環境</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">年号</th>
<th scope="col" class="org-right">価格(対数)</th>
<th scope="col" class="org-right">冬の降雨</th>
<th scope="col" class="org-right">気温</th>
<th scope="col" class="org-right">秋の降雨</th>
<th scope="col" class="org-right">経過年</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1952</td>
<td class="org-right">-0.99868</td>
<td class="org-right">600</td>
<td class="org-right">17.1167</td>
<td class="org-right">160</td>
<td class="org-right">31</td>
</tr>

<tr>
<td class="org-right">1953</td>
<td class="org-right">-0.4544</td>
<td class="org-right">690</td>
<td class="org-right">16.7333</td>
<td class="org-right">80</td>
<td class="org-right">30</td>
</tr>

<tr>
<td class="org-right">1954</td>
<td class="org-right">NA</td>
<td class="org-right">430</td>
<td class="org-right">15.3833</td>
<td class="org-right">180</td>
<td class="org-right">29</td>
</tr>

<tr>
<td class="org-right">1955</td>
<td class="org-right">-0.80796</td>
<td class="org-right">502</td>
<td class="org-right">17.15</td>
<td class="org-right">130</td>
<td class="org-right">28</td>
</tr>

<tr>
<td class="org-right">1956</td>
<td class="org-right">NA</td>
<td class="org-right">440</td>
<td class="org-right">15.65</td>
<td class="org-right">140</td>
<td class="org-right">27</td>
</tr>

<tr>
<td class="org-right">1957</td>
<td class="org-right">-1.50926</td>
<td class="org-right">420</td>
<td class="org-right">16.1333</td>
<td class="org-right">110</td>
<td class="org-right">26</td>
</tr>

<tr>
<td class="org-right">1958</td>
<td class="org-right">-1.71655</td>
<td class="org-right">582</td>
<td class="org-right">16.4167</td>
<td class="org-right">187</td>
<td class="org-right">25</td>
</tr>

<tr>
<td class="org-right">1959</td>
<td class="org-right">-0.418</td>
<td class="org-right">485</td>
<td class="org-right">17.4833</td>
<td class="org-right">187</td>
<td class="org-right">24</td>
</tr>

<tr>
<td class="org-right">&#x2026;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>
</tbody>
</table>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="org7a55745" class="figure">
<p><img src="./figs/r-wine01.png" alt="r-wine01.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 2: </span>ワインの価格と生産環境の関係</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="org6578fc5" class="figure">
<p><img src="./figs/r-wine05.png" alt="r-wine05.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 3: </span>生産環境によるワイン価格の予測 (重回帰)</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org8bf27a8">
<h3 id="org8bf27a8">主成分分析の考え方</h3>
<ul>
<li>多数の変数が与えられたときに，変数のもつ構造を効率的に記述できる少数個の特徴量を構成する</li>
<li>分析の事例:
<ul>
<li>野球選手の打撃成績(打率，本塁打数，打点など)から，打者としての特徴を記述する指標を作成する</li>
<li>複数銘柄からなる株価の時系列データから，市場全体の変動を記述する総合指標を作成する</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgcd2d204">
<h3 id="orgcd2d204">主成分分析の例 (<code>jpamenity.csv</code>)</h3>
<table id="org52a0e3d" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 3:</span> 県別の生活環境(一部)</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">昼夜人口比</th>
<th scope="col" class="org-right">年少人口比</th>
<th scope="col" class="org-right">老年人口比</th>
<th scope="col" class="org-right">人口増減率</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">北海道</td>
<td class="org-right">100.0</td>
<td class="org-right">11.7</td>
<td class="org-right">26.0</td>
<td class="org-right">-0.47</td>
</tr>

<tr>
<td class="org-left">青森県</td>
<td class="org-right">100.0</td>
<td class="org-right">12.1</td>
<td class="org-right">27.0</td>
<td class="org-right">-0.95</td>
</tr>

<tr>
<td class="org-left">岩手県</td>
<td class="org-right">99.7</td>
<td class="org-right">12.4</td>
<td class="org-right">27.9</td>
<td class="org-right">-0.84</td>
</tr>

<tr>
<td class="org-left">宮城県</td>
<td class="org-right">100.2</td>
<td class="org-right">13.0</td>
<td class="org-right">22.9</td>
<td class="org-right">-0.09</td>
</tr>

<tr>
<td class="org-left">秋田県</td>
<td class="org-right">99.9</td>
<td class="org-right">11.1</td>
<td class="org-right">30.7</td>
<td class="org-right">-1.12</td>
</tr>

<tr>
<td class="org-left">山形県</td>
<td class="org-right">99.8</td>
<td class="org-right">12.6</td>
<td class="org-right">28.3</td>
<td class="org-right">-0.78</td>
</tr>

<tr>
<td class="org-left">福島県</td>
<td class="org-right">99.6</td>
<td class="org-right">12.9</td>
<td class="org-right">26.1</td>
<td class="org-right">-1.41</td>
</tr>

<tr>
<td class="org-left">茨城県</td>
<td class="org-right">97.2</td>
<td class="org-right">13.2</td>
<td class="org-right">23.8</td>
<td class="org-right">-0.51</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
</tr>
</tbody>
</table>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="org9d49034" class="figure">
<p><img src="./figs/p-jpamenity01.png" alt="p-jpamenity01.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 4: </span>県別の生活環境(人口動態)の散布図</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="orgd3f7b7b" class="figure">
<p><img src="./figs/p-jpamenity02.png" alt="p-jpamenity02.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 5: </span>県別の生活環境(教育・労働)の散布図</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="orgfed73fc" class="figure">
<p><img src="./figs/p-jpamenity03.png" alt="p-jpamenity03.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 6: </span>県別の生活環境(貯蓄・余暇)の散布図</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="orgf129076" class="figure">
<p><img src="./figs/p-jpamenity06.png" alt="p-jpamenity06.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 7: </span>県別の生活環境の主成分分析</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgab167a3">
<h3 id="orgab167a3">判別分析の考え方</h3>
<ul>
<li>ある個体が複数のクラスのいずれかに属するとき，その個体の特徴量からどのクラスに属するか予測するモデルを構築する</li>
<li>分析の事例:
<ul>
<li>花の種類を，その花の花弁の幅・長さおよび萼片(がくへん)の幅・長さから判別する</li>
<li>食道がんを患っている人とそうでない人を，年齢・飲酒量・喫煙度から判別する</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgbc8ca8e">
<h3 id="orgbc8ca8e">判別分析の例 (<code>MASS::biopsy</code>)</h3>
<table id="orgf2f8552" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 4:</span> 乳癌患者の生研検査</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">ID</th>
<th scope="col" class="org-right">V1</th>
<th scope="col" class="org-right">V2</th>
<th scope="col" class="org-right">V3</th>
<th scope="col" class="org-right">V4</th>
<th scope="col" class="org-right">V5</th>
<th scope="col" class="org-right">V6</th>
<th scope="col" class="org-right">V7</th>
<th scope="col" class="org-right">V8</th>
<th scope="col" class="org-right">V9</th>
<th scope="col" class="org-left">class</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1000025</td>
<td class="org-right">5</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">1</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-left">benign</td>
</tr>

<tr>
<td class="org-right">1002945</td>
<td class="org-right">5</td>
<td class="org-right">4</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">7</td>
<td class="org-right">10</td>
<td class="org-right">3</td>
<td class="org-right">2</td>
<td class="org-right">1</td>
<td class="org-left">benign</td>
</tr>

<tr>
<td class="org-right">1015425</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-left">benign</td>
</tr>

<tr>
<td class="org-right">1016277</td>
<td class="org-right">6</td>
<td class="org-right">8</td>
<td class="org-right">8</td>
<td class="org-right">1</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">3</td>
<td class="org-right">7</td>
<td class="org-right">1</td>
<td class="org-left">benign</td>
</tr>

<tr>
<td class="org-right">1017023</td>
<td class="org-right">4</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">3</td>
<td class="org-right">2</td>
<td class="org-right">1</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-left">benign</td>
</tr>

<tr>
<td class="org-right">1017122</td>
<td class="org-right">8</td>
<td class="org-right">10</td>
<td class="org-right">10</td>
<td class="org-right">8</td>
<td class="org-right">7</td>
<td class="org-right">10</td>
<td class="org-right">9</td>
<td class="org-right">7</td>
<td class="org-right">1</td>
<td class="org-left">malignant</td>
</tr>

<tr>
<td class="org-right">1018099</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">10</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-left">benign</td>
</tr>

<tr>
<td class="org-right">1018561</td>
<td class="org-right">2</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">1</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-left">benign</td>
</tr>

<tr>
<td class="org-right">&#x2026;</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-left">&#x2026;</td>
</tr>
</tbody>
</table>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="org1b785d9" class="figure">
<p><img src="./figs/d-biopsy01.png" alt="d-biopsy01.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 8: </span>乳癌患者(良性・悪性)の生研検査の散布図</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="org1f0d4b9" class="figure">
<p><img src="./figs/d-biopsy02.png" alt="d-biopsy02.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 9: </span>生研検査の主成分分析</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="org47dec84" class="figure">
<p><img src="./figs/d-biopsy03.png" alt="d-biopsy03.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 10: </span>生研検査による乳癌患者の判別分析</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orga43242a">
<h3 id="orga43242a">クラスタ分析の考え方</h3>
<ul>
<li>特徴量の違いに着目して，妥当な個体のグループ(クラスタ)を構成する
<ul>
<li>階層的な方法: 系統樹を作成する</li>
<li>非階層的な方法: グループの代表値を推定する</li>

</ul></li>
<li>分析の事例:
<ul>
<li>映画に関するアンケート調査から潜在的なジャンル(グループ)を抽出する</li>
<li>顧客の購買履歴から，嗜好の異なる顧客グループに分類し，グループごとの販売戦略を立てる</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgb276314">
<h3 id="orgb276314">クラスタ分析の例 (<code>omusubi.csv</code>)</h3>
<table id="org7a12d79" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 5:</span> おむすびの具に関するアンケート</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">梅</th>
<th scope="col" class="org-right">鮭</th>
<th scope="col" class="org-right">昆布</th>
<th scope="col" class="org-right">鰹</th>
<th scope="col" class="org-right">明太</th>
<th scope="col" class="org-right">鱈子</th>
<th scope="col" class="org-right">ツナ</th>
<th scope="col" class="org-right">他</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">北海道</td>
<td class="org-right">13.86</td>
<td class="org-right">27.94</td>
<td class="org-right">5.58</td>
<td class="org-right">5.26</td>
<td class="org-right">9.26</td>
<td class="org-right">15.06</td>
<td class="org-right">11.61</td>
<td class="org-right">11.39</td>
</tr>

<tr>
<td class="org-left">青森</td>
<td class="org-right">14.93</td>
<td class="org-right">30.79</td>
<td class="org-right">7.01</td>
<td class="org-right">2.43</td>
<td class="org-right">10.36</td>
<td class="org-right">11.58</td>
<td class="org-right">11.58</td>
<td class="org-right">11.28</td>
</tr>

<tr>
<td class="org-left">岩手</td>
<td class="org-right">17.91</td>
<td class="org-right">23.13</td>
<td class="org-right">5.22</td>
<td class="org-right">3.35</td>
<td class="org-right">17.91</td>
<td class="org-right">10.07</td>
<td class="org-right">10.44</td>
<td class="org-right">11.94</td>
</tr>

<tr>
<td class="org-left">宮城</td>
<td class="org-right">15.16</td>
<td class="org-right">29.5</td>
<td class="org-right">10</td>
<td class="org-right">1.66</td>
<td class="org-right">14.83</td>
<td class="org-right">8.83</td>
<td class="org-right">12.83</td>
<td class="org-right">7.16</td>
</tr>

<tr>
<td class="org-left">秋田</td>
<td class="org-right">10.63</td>
<td class="org-right">31.38</td>
<td class="org-right">5.31</td>
<td class="org-right">3.19</td>
<td class="org-right">14.89</td>
<td class="org-right">13.29</td>
<td class="org-right">10.63</td>
<td class="org-right">10.63</td>
</tr>

<tr>
<td class="org-left">山形</td>
<td class="org-right">16.58</td>
<td class="org-right">20.27</td>
<td class="org-right">8.29</td>
<td class="org-right">1.38</td>
<td class="org-right">18.89</td>
<td class="org-right">10.13</td>
<td class="org-right">12.9</td>
<td class="org-right">11.52</td>
</tr>

<tr>
<td class="org-left">福島</td>
<td class="org-right">12.37</td>
<td class="org-right">21.99</td>
<td class="org-right">8.93</td>
<td class="org-right">3.43</td>
<td class="org-right">16.49</td>
<td class="org-right">9.62</td>
<td class="org-right">19.24</td>
<td class="org-right">7.9</td>
</tr>

<tr>
<td class="org-left">茨城</td>
<td class="org-right">15.42</td>
<td class="org-right">26.49</td>
<td class="org-right">7.98</td>
<td class="org-right">2.54</td>
<td class="org-right">18.33</td>
<td class="org-right">11.79</td>
<td class="org-right">11.79</td>
<td class="org-right">5.62</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
</tr>
</tbody>
</table>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="orgd86df75" class="figure">
<p><img src="./figs/c-omusubi01.png" alt="c-omusubi01.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 11: </span>おむすびの具に関するアンケート分析 (県別の集計)</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="org3e968b9" class="figure">
<p><img src="./figs/c-omusubi02.png" alt="c-omusubi02.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 12: </span>アンケート結果にもとづく県のクラスタ分析</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org11d92e4">
<h3 id="org11d92e4">時系列解析の考え方</h3>
<ul>
<li>時間とともに変化する現象を記述するために，未来の値を過去の値で近似する式を構成する
<ul>
<li>自己回帰 (ARモデル): 過去の影響の記述</li>
<li>移動平均 (MAモデル): 記憶のある不確定性</li>

</ul></li>
<li>分析の事例:
<ul>
<li>市町村の過去の年齢別の人口変動から将来の人口比率を予測する</li>
<li>食品・飲料の季節ごとの販売履歴から将来の需要量を予測する</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org4dcb258">
<h3 id="org4dcb258">時系列解析の例 (<code>datasets::AirPassengers</code>)</h3>
<table id="org011228c" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 6:</span> 航空機旅客量の変遷</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">Jan</th>
<th scope="col" class="org-right">Feb</th>
<th scope="col" class="org-right">Mar</th>
<th scope="col" class="org-right">Apr</th>
<th scope="col" class="org-right">May</th>
<th scope="col" class="org-right">Jun</th>
<th scope="col" class="org-right">Jul</th>
<th scope="col" class="org-right">Aug</th>
<th scope="col" class="org-right">Sep</th>
<th scope="col" class="org-left">&#x2026;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1949</td>
<td class="org-right">112</td>
<td class="org-right">118</td>
<td class="org-right">132</td>
<td class="org-right">129</td>
<td class="org-right">121</td>
<td class="org-right">135</td>
<td class="org-right">148</td>
<td class="org-right">148</td>
<td class="org-right">136</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">1950</td>
<td class="org-right">115</td>
<td class="org-right">126</td>
<td class="org-right">141</td>
<td class="org-right">135</td>
<td class="org-right">125</td>
<td class="org-right">149</td>
<td class="org-right">170</td>
<td class="org-right">170</td>
<td class="org-right">158</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">1951</td>
<td class="org-right">145</td>
<td class="org-right">150</td>
<td class="org-right">178</td>
<td class="org-right">163</td>
<td class="org-right">172</td>
<td class="org-right">178</td>
<td class="org-right">199</td>
<td class="org-right">199</td>
<td class="org-right">184</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">1952</td>
<td class="org-right">171</td>
<td class="org-right">180</td>
<td class="org-right">193</td>
<td class="org-right">181</td>
<td class="org-right">183</td>
<td class="org-right">218</td>
<td class="org-right">230</td>
<td class="org-right">242</td>
<td class="org-right">209</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">1953</td>
<td class="org-right">196</td>
<td class="org-right">196</td>
<td class="org-right">236</td>
<td class="org-right">235</td>
<td class="org-right">229</td>
<td class="org-right">243</td>
<td class="org-right">264</td>
<td class="org-right">272</td>
<td class="org-right">237</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">1954</td>
<td class="org-right">204</td>
<td class="org-right">188</td>
<td class="org-right">235</td>
<td class="org-right">227</td>
<td class="org-right">234</td>
<td class="org-right">264</td>
<td class="org-right">302</td>
<td class="org-right">293</td>
<td class="org-right">259</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">1955</td>
<td class="org-right">242</td>
<td class="org-right">233</td>
<td class="org-right">267</td>
<td class="org-right">269</td>
<td class="org-right">270</td>
<td class="org-right">315</td>
<td class="org-right">364</td>
<td class="org-right">347</td>
<td class="org-right">312</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">&#x2026;</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-right">..</td>
<td class="org-left">&#x2026;</td>
</tr>
</tbody>
</table>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="orgd8804b0" class="figure">
<p><img src="./figs/t-airpass01.png" alt="t-airpass01.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 13: </span>航空機旅客量の変遷</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="orge34cdd6" class="figure">
<p><img src="./figs/t-airpass04.png" alt="t-airpass04.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 14: </span>階差時系列の自己相関分析</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="orgff9c8c9" class="figure">
<p><img src="./figs/t-airpass12.png" alt="t-airpass12.png" width="55%" height="55%" />
</p>
<p><span class="figure-number">Figure 15: </span>航空機旅客量の予測 (SARIMAモデルによる)</p>
</div>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgab043ea">
<h2 id="orgab043ea">RStudio の基礎</h2>
<div class="outline-text-2" id="text-orgab043ea">
</div>
</section>
<section id="slide-orgd886671">
<h3 id="orgd886671">起動画面</h3>
<ul>
<li><b>以下 RStudio を用いて説明する</b></li>
<li>起動すると4つのペイン(pane)を持つウィンドウが立ち上がる
<ul>
<li>左上: エディタ (開いていない場合もある)</li>
<li>左下: コンソール</li>
<li>右上: 作業環境内の変数・コマンド履歴</li>
<li>右下: パッケージ・グラフィックス・ヘルプ</li>

</ul></li>
<li><span style="color:orange;">ペインの配置や数は個別に設定することもできる</span></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orga7f3d6d">
<h3 id="orga7f3d6d">コンソール (左下)</h3>
<ul>
<li>コマンドを入力するためのペイン</li>
<li><p>
例えば，以下のような計算を行うことができる
</p>
<div class="org-src-container">

<pre><code class="R" >## 一般的な数式を入力すれば計算機として使える
## "#" 以降はコメントとして無視される
1 + 2 + 3 + 4 # 空白は無視される
sin(pi/3) / cos(pi/3) # tan(pi/3) になるはず
</code></pre>
</div></li>
<li><p>
コンソール上で終了を指示する以下のコマンドを入力すれば
R を終了させることができる
</p>
<div class="org-src-container">

<pre><code class="R" >## R の終了には q() または quit() を用いる
q()
</code></pre>
</div>
<ul>
<li>メニューの <b>Quit RStudio</b> も利用可能</li>
<li><span style="color:orange;">終了できない場合はOSの機能で強制終了</span></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org0c1dc7b">
<h3 id="org0c1dc7b">作業ディレクトリ</h3>
<ul>
<li>プログラムが実行されるディレクトリ(フォルダ)</li>
<li>作業ディレクトリにあるファイルの読み書きはパスを指定する必要がない</li>
<li>現在の作業ディレクトリはコンソールタブで確認</li>
<li><b>Session</b> メニューの <b>Set Working Directory</b> で指定
<ul>
<li>読み込んだファイルの場所を選択</li>
<li><b>Files</b> タブ (右下ペイン) の場所を選択 (<b>More</b> からも選択可)</li>
<li>ディレクトリを直接選択</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org5ceb64a">
<h3 id="org5ceb64a">プロジェクト</h3>
<ul>
<li>作業環境をまとめて設定
<ul>
<li>作成したプロジェクトは <b>Project</b> メニューから選択可能</li>
<li>いつでもプロジェクトを中断可能</li>
<li>プロジェクト毎に履歴や変数を保存可能</li>
<li>複数のプロジェクトを定義可能</li>

</ul></li>
<li>一般的なプロジェクトの作成手順
<ul>
<li>右上の <b>Project</b> メニューから <b>New Project</b> を選択</li>
<li><b>Create Project</b> ダイアログで <b>New Directory</b> を選択</li>
<li><b>Project Type</b> ダイアログで <b>New Project</b> を選択</li>
<li><b>Directry Name</b> とその親ディレクトリを指定</li>
<li>中断するときは <b>Close Project</b> を選択</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org2953826">
<h3 id="org2953826">エディタ (左上)</h3>
<ul>
<li>コマンドを記述したファイルを扱うためのペイン</li>
<li>一連のコマンドをまとめたり，修正しながら実行するための機能
<ul>
<li><span style="color:orange;">コンソールに入力したコマンドは直ちに実行されてしまう</span></li>
<li>コマンドを実行順に記述したファイル <b>RScript</b> を作成</li>
<li>ファイルを保存</li>
<li>ファイルを実行</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org07ea2d6">
<h3 id="org07ea2d6">ヘルプ機能 (右下)</h3>
<ul>
<li>各関数の詳細(機能，引数名，引数の既定値，実行例など)を記述した
ヘルプが用意されている</li>
<li>右下ペイン <b>Help</b> タブ右上の検索窓で参照可能</li>
<li>ヘルプ内の検索はその下の <b>Find in Topic</b> で可能</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgd9bb324">
<h3 id="orgd9bb324">パッケージの操作 (右下)</h3>
<ul>
<li>機能を拡張するために多数のパッケージが用意されている</li>
<li>RStudio でのインストール手順
<ul>
<li>右下ペイン <b>Package</b> タブをクリック</li>
<li>左上の <b>Install</b> をクリック</li>
<li>パッケージ名を入力し <b>Install</b> をクリック</li>

</ul></li>
<li>利用可能なパッケージの情報は
右下ペイン <b>Package</b> タブで確認できる</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgad78dfd">
<h3 id="orgad78dfd">終了時の注意</h3>
<ul>
<li><p>
終了時にコンソールに以下のメッセージが表示される場合がある
</p>
<div class="org-src-container">

<pre><code class="R" >&gt; q()
Save workspace image? [y/n/c]:     
</code></pre>
</div></li>
<li>作業で使った変数などをセーブするか尋ねている
<ul>
<li><code>y</code> を入力: セーブする (yesの略)</li>
<li><code>n</code> を入力: セーブしない (noの略)</li>
<li><code>c</code> を入力: Rの終了をキャンセルする (cancelの略)</li>

</ul></li>
<li>セーブした場合次回起動時に読み込まれる</li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org8b1dde0">
<h2 id="org8b1dde0">基本的な使い方</h2>
<div class="outline-text-2" id="text-org8b1dde0">
</div>
</section>
<section id="slide-org04d742c">
<h3 id="org04d742c">式の入力</h3>
<ul>
<li>四則演算や数学関数は直感的な文法で計算可能
<ul>
<li>+ (加算)，- (減算)，* (乗算)，/ (除算)，＾または** (ベキ乗)</li>
<li>sin, cos, tan (三角関数)，exp (指数関数)，log (対数関数)</li>

</ul></li>
<li><p>
<span style="color:darkgreen;">コンソール上での計算例</span>
</p>
<div class="org-src-container">

<pre><code class="R" >## コンソールに以下のコマンドを入力してみる
123 * 456 - 789
(2^2^5 + 1) / 641
sin(pi/3)^2 + cos(pi/3)^2
</code></pre>
</div>

<pre class="example">
[1] 55299
[1] 6700417
[1] 1
</pre></li>

<li>入力内容は右上の <b>History</b> タブで確認可能</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org2817023">
<h3 id="org2817023">エディタからの実行</h3>
<ul>
<li>新規ファイルの作成 (以下のいずれか)
<ul>
<li>左上の <b>+</b> から
<b>R Script</b> を選択</li>
<li><b>File</b> から
<b>New File</b> を選択，
更に <b>R Script</b> を選択</li>

</ul></li>
<li>エディタ上でコマンドを記述</li>
<li>実行範囲の選択
<ul>
<li>一行のみ: カーソルをその行に移動</li>
<li>複数行: クリックしてながら移動して選択する</li>

</ul></li>
<li>選択範囲の実行 (以下のいずれか)
<ul>
<li>左上の <b>Run</b> をクリック</li>
<li><b>Code</b> から 
<b>Selected Line(s)</b> を選択
(Ctrl/Command+Enter)</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org14c3674">
<h3 id="org14c3674">ファイルの保存</h3>
<ul>
<li>ファイルの保存 (以下のいずれか)
<ul>
<li>左上のディスクのマークをクリック</li>
<li><b>File</b> から 
<b>Save</b> を選択 (Ctrl/Command+S)</li>

</ul></li>
<li>ファイル作成に関する注意
<ul>
<li>保存する時にファイル名の入力が求められる</li>
<li>拡張子は通常
<b>.R</b> または
<b>.r</b> を利用する</li>
<li><b>#</b> 以降の字列は実行されないのでコメントとして有用</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org39add09">
<h3 id="org39add09">関数の実行</h3>
<ul>
<li>関数の取り扱いは一般的な計算機言語とほぼ同様</li>
<li>関数は引数とその値を指定して実行</li>
<li><p>
<span style="color:darkgreen;">正弦関数の計算</span>
</p>
<div class="org-src-container">

<pre><code class="R" >sin(x = pi/2)
## 上と同値．関数の定義どおりの順序であれば引数の名前は省略可能
sin(pi/2) 
</code></pre>
</div></li>
<li><p>
<span style="color:darkgreen;">対数関数の計算</span>
</p>
<div class="org-src-container">

<pre><code class="R" >## xやbに具体的な数値を代入して実行しなさい
log(x, b) # 底をbとする対数
log(x=x, base=b) #上と同値
log(base=b, x=x) #上と同値
log(b,x) # = log(x=b,base=x) 
log(x) # base を省略すると自然対数 =log(x,base=exp(1))
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org408aad3">
<h3 id="org408aad3">オブジェクト</h3>
<ul>
<li>Rではさまざまな数値を扱うことができる
<ul>
<li>実数および複素数 (指数表記にも対応)</li>
<li>無限大や不定な数など特殊なものにも対応</li>

</ul></li>
<li>変数，関数，計算結果などを <b>オブジェクト</b> と呼ぶ</li>
<li>文字列を変数名としてオブジェクトを保持することができる</li>
<li>保持しているオブジェクトの情報は右上ペインの
<b>Environment</b> タブで確認できる</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org9b80b90">
<h3 id="org9b80b90">オブジェクトの代入</h3>
<ul>
<li>オブジェクトの内容(情報)を別のオブジェクトに代入することができる</li>
<li>計算結果や良く使う文字列の保存に利用できる</li>
<li><p>
<span style="color:darkgreen;">代入操作</span>
</p>
<div class="org-src-container">

<pre><code class="R" >## 数値を変数 foo に代入する
(foo &lt;- 3)
## 変数 foo を用いて計算し，結果を bar に代入する
bar &lt;- sin(2/3*pi) + cos(foo * pi/4)
## 変数 bar の内容を表示する
print(bar) 
</code></pre>
</div>

<pre class="example">
[1] 3
[1] 0.1589186
</pre></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgb96bee1">
<h3 id="orgb96bee1">データの読み込み</h3>
<ul>
<li>ファイルにまとめられたデータを読み込むことができる</li>
<li>対応する形式は csv・excel など</li>
<li>右下ペインの <b>Files</b> を利用する
<ul>
<li>ファイルが保存されているディレクトリに移動</li>
<li>ファイルをクリック</li>
<li><b>View File</b> (見るだけ) か <b>Import Dataset</b> (読み込み) を選択</li>

</ul></li>
<li>この機能は次回以降のデータの整理で活躍する</li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,
overview: true,

transition: 'fade',
transitionSpeed: 'default',
spotlight: { size: 90, initialPresentationMode: false }, chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }, 84: function() { RevealSpotlight.toggleSpotlight() }, 81: function() { RevealSpotlight.togglePresentationMode()}},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'},
{ src: './reveal.js/plugin/spotlight/spotlight.js'}]

});
</script>
</body>
</html>
