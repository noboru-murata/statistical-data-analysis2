<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>時系列解析</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">時系列解析</h1>
</div>
<div class="talk-subtitle">
    <p>時系列の基本モデル</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>
<section>
<section id="slide-org4b9db7d">
<h2 id="org4b9db7d">講義概要</h2>
<ul>
<li><b>第1回 : 時系列の基本モデル</b></li>
<li>第2回 : モデルの推定と予測</li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org37d02fb">
<h2 id="org37d02fb">時系列解析の概要</h2>
<div class="outline-text-2" id="text-org37d02fb">
</div>
</section>
<section id="slide-org1e6dc84">
<h3 id="org1e6dc84">時系列解析とは</h3>
<ul>
<li>時系列データ
<ul>
<li>時間軸に沿って観測されたデータ</li>
<li>観測の順序に意味がある</li>
<li>異なる時点間での観測データの従属関係が重要</li>
<li><b>独立性にもとづく解析は行えない</b>
<ul>
<li>そのままでは大数の法則や中心極限定理は使えない</li>

</ul></li>

</ul></li>
<li>時系列解析の目的
<ul>
<li>時系列データの特徴を効果的に記述すること</li>
<li>時系列モデルの推定と評価</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org669fb69">
<h3 id="org669fb69">時系列データ</h3>
<ul>
<li><p>
統計学・確率論における表現 : <b>確率過程</b>
</p>
<blockquote>
<p>
時間を添え字として持つ確率変数列
</p>
<div>
\begin{equation}
  X_{t},\;t=1,2,\dotsc,T
  \quad(\text{あるいは}\;t=0,1,\dotsc,T)
\end{equation}

</div>
</blockquote></li>
<li>時系列解析で利用される代表的な確率過程
<ul>
<li>ホワイトノイズ</li>
<li>ランダムウォーク</li>
<li>自己回帰モデル (ARモデル)</li>
<li>移動平均モデル (MAモデル)</li>
<li>自己回帰移動平均モデル (ARMAモデル)</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgc52adfe">
<h2 id="orgc52adfe">基本的なモデル</h2>
<div class="outline-text-2" id="text-orgc52adfe">
</div>
</section>
<section id="slide-org3ece98a">
<h3 id="org3ece98a">ホワイトノイズ</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
平均 \(0\) 分散 \(\sigma^2\)
である確率変数の
確率分布 \(P\) からの
独立かつ同分布な確率変数列
</p>
<div>
\begin{equation}
  X_{t}
  =
  \epsilon_{t},
  \quad
  \epsilon_{t}
  \overset{i.i.d.}{\sim} P
\end{equation}

</div>
</blockquote>

<ul>
<li><p>
記号 \(\mathrm{WN}(0,\sigma^2)\) で表記することが多い
</p>
<blockquote>
<div>
\begin{equation}
  X_{t}
  \sim
  \mathrm{WN}(0,\sigma^2)
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li>独立であるため系列としての予測は不可能</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="org73fc412" class="figure">
<p><img src="figs/12_wn.png" alt="12_wn.png" />
</p>
<p><span class="figure-number">Figure 1: </span>ホワイトノイズ (標準正規分布)</p>
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org0c29580">
<h3 id="org0c29580">トレンドのあるホワイトノイズ</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
\(\mu,\alpha\) を定数として
以下で定義される確率過程
</p>
<div>
\begin{equation}
  X_{t}=\mu+\alpha t+\epsilon_{t},
  \quad
  \epsilon_{t}
  \sim
  \mathrm{WN}(0,\sigma^2)
\end{equation}

</div>
</blockquote></li>
<li><b>トレンド</b> \(\mu+\alpha t\) はより一般化されることもある
<ul>
<li>\(t\) の1次式 (上記の基本的な場合)</li>
<li>高次の多項式</li>
<li>非線形関数(指数関数, 三角関数など)</li>

</ul></li>
<li><b>平均</b> が時間とともに変動する時系列モデルの1つ</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="orge88a4a8" class="figure">
<p><img src="figs/12_trwn.png" alt="12_trwn.png" />
</p>
<p><span class="figure-number">Figure 2: </span>トレンドのあるホワイトノイズ</p>
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orge387c1d">
<h3 id="orge387c1d">ランダムウォーク</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
\(X_0\) を定数もしくは確率変数として
以下で帰納的に定義される確率過程
</p>
<div>
\begin{equation}
  X_{t}=X_{t-1}+\epsilon_{t},
  \quad
  \epsilon_{t}
  \sim
  \mathrm{WN}(0,\sigma^2)
\end{equation}

</div>
</blockquote></li>
<li><b>分散</b> が時間とともに増加する時系列モデルの1つ</li>
<li>最も単純な <b>記憶</b> のあるモデル</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="orgecc39a9" class="figure">
<p><img src="figs/12_rw.png" alt="12_rw.png" />
</p>
<p><span class="figure-number">Figure 3: </span>ランダムウォーク</p>
</div>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org518fae4" data-background="#f4fef4">
<h2 id="org518fae4">実習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orga5fd24b" data-background="#fef4f4">
<h3 id="orga5fd24b">R : 時系列データの扱い</h3>
<ul>
<li>関連するパッケージ
<ul>
<li><b>stats</b> : base R の基本的な統計に関するパッケージ
<ul>
<li>関数 <code>ts()</code>, <code>acf()</code> など</li>
<li>標準でインストールされている</li>

</ul></li>
<li><p>
<b>forecast</b> : 時系列モデルの推定・予測のためのパッケージ
</p>
<div class="org-src-container">

<pre><code class="R" >#' 最初に一度だけ以下のいずれかを実行しておく
#'  - Package タブから forecast をインストール
#'  - コンソール上で次のコマンドを実行 'install.packages("forecast")'
</code></pre>
</div>
<ul>
<li><code>zoo</code>, <code>xts</code> などの時系列パッケージも同時にインストールされる</li>

</ul></li>
<li><b>ggfortify</b> : ggplotによる描画を補助するパッケージ
<ul>
<li>関数 <code>autoplot()</code> など</li>
<li>既に導入済み</li>

</ul></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgac5d369" data-background="#fef4f4">
<h3 id="orgac5d369">R : 時系列の作成</h3>
<ul>
<li><p>
関数 <code>stats::ts()</code>
</p>
<div class="org-src-container">

<pre><code class="R" >ts(data = NA, start = 1, end = numeric(), frequency = 1,
   deltat = 1, ts.eps = getOption("ts.eps"),
   class = if(nseries &gt; 1) c("mts", "ts", "matrix", "array") else "ts",
   names = )
#' data: ベクトル，または行列(データフレーム)
#' start: 開始時刻
#' end: 終了時刻
#' frequency: 単位時間あたりの観測回数
</code></pre>
</div>
<ul>
<li><p>
<span style="color:green;">典型的な使い方</span>
</p>
<div class="org-src-container">

<pre><code class="R" >x &lt;- rnorm(24) # 正規分布のホワイトノイズ
ts(data = x) # t=1,2,... を添字とする単純な時系列
ts(data = x, start = c(2020,1), frequency =12) # 2020年1月からの月ごと
ts(data = x, start = c(2020,3), frequency =4) # 四半期ごと
</code></pre>
</div>
<ul>
<li><code>ts</code> オブジェクトは通常その時間情報を利用して処理が行われるため
関数によっては扱いがベクトルと異なる場合があるので注意</li>

</ul></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org0698094" data-background="#fef4f4">
<h3 id="org0698094">R : 時系列の描画</h3>
<ul>
<li><p>
関数 ggfortify::autoplot()
</p>
<div class="org-src-container">

<pre><code class="R" >autoplot(object,
         facets = TRUE, nrow = NULL, ncol = 1, scales = "free_y",
         ts.geom = "line", ts.colour = NULL, ts.size = NULL, ts.linetype = NULL,
         ts.alpha = NULL, ts.fill = NULL, ts.shape = NULL, ...)
#' 詳細は '?ggfortify::autoplot.ts()'を参照
</code></pre>
</div>
<ul>
<li><p>
<span style="color:green;">典型的な使い方</span>
</p>
<div class="org-src-container">

<pre><code class="R" >#' 単一時系列の描画
x &lt;- rnorm(240) # 正規分布のホワイトノイズ
autoplot(ts(x, start = c(2000,1), frequency = 12)) # 2000年1月から毎月のデータ
#' 複数の系列を表示する場合
y &lt;- rt(240, df=4) # t-分布のホワイトノイズ
z &lt;- ts(tibble(x,y), start = c(2000,1), frequency = 12) 
autoplot(z, ts.colour = "red") # 既定値では個別のグラフ
autoplot(z, facets = FALSE) # facetsを偽とすれば同一のグラフ
</code></pre>
</div></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org8fd1cd1" data-background="#f4fef4">
<h3 id="org8fd1cd1">練習問題</h3>
<ul>
<li>指定された確率過程を生成して図示しなさい
<ul>
<li>平均0，分散4の正規分布に従うホワイトノイズ</li>
<li>上記のホワイトノイズに
初期値-1で単位時刻あたり1/20で増加するトレンドを持つ確率過程</li>
<li>上記のホワイトノイズから生成されるランダムウォーク</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org1f2fd50">
<h2 id="org1f2fd50">より一般的なモデル</h2>
<div class="outline-text-2" id="text-org1f2fd50">
</div>
</section>
<section id="slide-org6e8c66b">
<h3 id="org6e8c66b">自己回帰過程</h3>
<ul>
<li><p>
定義 (AR(p); 次数 \(p\) の auto regressive の略)
</p>
<blockquote>
<p>
\(a_1,\dotsc,a_p\)を定数とし
\(X_1,\dotsc,X_p\)が初期値として与えられたとき
以下で帰納的に定義される確率過程
</p>
<div>
\begin{equation}
  X_{t}=a_1X_{t-1}+\cdots+a_pX_{t-p}+\epsilon_{t},
  \quad
  \epsilon_{t}
  \sim
  \mathrm{WN}(0,\sigma^2)
\end{equation}

</div>
</blockquote>
<ul>
<li>ランダムウォークの一般化
<ul>
<li>\(p=1, a_1=1\) かつ \(\epsilon_{t}\) が独立同分布ならランダムウォーク</li>

</ul></li>
<li><b>忘却</b> しながら記憶するモデル (\(|a_i|<1\) などの条件が必要)</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="org6d55b94" class="figure">
<p><img src="figs/12_ar.png" alt="12_ar.png" />
</p>
<p><span class="figure-number">Figure 4: </span>AR過程</p>
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgac76ba5">
<h3 id="orgac76ba5">移動平均過程</h3>
<ul>
<li><p>
定義 (MA(q); 次数 \(q\) の moving average の略)
</p>
<blockquote>
<p>
\(b_1,\dotsc,b_q\)を定数とし，
\(X_1,\dotsc,X_q\)が初期値として与えられたとき
以下で帰納的に定義される確率過程
</p>
<div>
\begin{equation}
  X_{t}
  =
  b_1\epsilon_{t-1}+\cdots+b_q\epsilon_{t-q}+\epsilon_{t},
  \quad
  \epsilon_{t}
  \sim
  \mathrm{WN}(0,\sigma^2)
\end{equation}

</div>
</blockquote>
<ul>
<li>記憶のあるホワイトノイズ (構成する部品を記憶)</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>


<div id="orgf729680" class="figure">
<p><img src="figs/12_ma.png" alt="12_ma.png" />
</p>
<p><span class="figure-number">Figure 5: </span>MA過程</p>
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc003926">
<h3 id="orgc003926">自己回帰移動平均過程</h3>
<ul>
<li><p>
定義 (ARMA(\(p,q\)); 次数 \((p,q)\))
</p>
<blockquote>
<p>
\(a_1,\dotsc,a_p,b_1,\dotsc,b_q\) を定数とし
\(X_1,\dotsc,X_{\max\{p,q\}}\) が初期値として与えられたとき
以下で帰納的に定まる確率過程
</p>
<div>
\begin{align}
  X_{t}
  &=
    a_1X_{t-1}+\cdots+a_pX_{t-p}\\
  &\quad+
    b_1\epsilon_{t-1}+\cdots+b_q\epsilon_{t-q}
    +\epsilon_{t},\\
  &\quad
    \epsilon_{t}
    \sim
    \mathrm{WN}(0,\sigma^2)
\end{align}

</div>
</blockquote>
<ul>
<li>AR(\(p\))モデルはARMA(\(p,0\))，MA(\(q\))モデルはARMA(\(0,q\))</li>
<li>単純な形ながら異なる時点間の従属構造を柔軟に記述</li>
<li>基本的な時系列モデルとして広く利用されている</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>


<div id="orgb9a4214" class="figure">
<p><img src="figs/12_arma.png" alt="12_arma.png" />
</p>
<p><span class="figure-number">Figure 6: </span>ARMA過程</p>
</div>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgf2dba1f" data-background="#f4fef4">
<h2 id="orgf2dba1f">実習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc9fd395" data-background="#f4fef4">
<h3 id="orgc9fd395">練習問題</h3>
<ul>
<li>平均0，分散1のホワイトノイズを用いて，
以下の指定された確率過程を生成し，図示しなさい
<ul>
<li>係数\(a_{1}=0.67,a_{2}=0.26\)を持つAR(2)過程</li>
<li>係数\(b_{1}=0.44,b_{2}=0.08\)を持つMA(2)過程</li>
<li>係数\(a_{1}=0.8,a_{2}=-0.64,b_{1}=-0.5\)を持つARMA(2,1)過程</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orge5ed31e">
<h2 id="orge5ed31e">定常過程と非定常過程</h2>
<div class="outline-text-2" id="text-orge5ed31e">
</div>
</section>
<section id="slide-org8c9fbed">
<h3 id="org8c9fbed">弱定常性</h3>
<ul>
<li>確率過程\(X_{t},\;t=1,\dotsc,T\)が次の性質をもつ 
<ul>
<li><p>
\(X_{t}\)の平均は時点\(t\)によらない
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[X_{t}]=\mu
  \quad
  \text{(時間の添字を持たない)}
\end{equation}

</div>
</blockquote></li>
<li><p>
\(X_{t}\)と\(X_{t+h}\)の共分散は時点\(t\)によらず時差\(h\)のみで定まる
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Cov}(X_{t},X_{t+h})
  =\gamma(h)
  \quad
  \text{(時間の添字を持たない)}
\end{equation}

</div>
</blockquote></li>
<li><p>
特に\(X_{t}\)の分散は時点\(t\)によらない (\(h=0\)の場合)
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Var}(X_{t})
  =\gamma(0),
  \quad
  \text{(\(X_{t}\)は二乗可積分であることを仮定)}
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org84cb1e9">
<h3 id="org84cb1e9">定常性と非定常性</h3>
<ul>
<li>定常でない確率過程は <b>非定常</b> であるという</li>
<li>いろいろな確率過程の定常性
<ul>
<li>定常 : ホワイトノイズ, MA</li>
<li>非定常 : トレンドのあるホワイトノイズ, ランダムウォーク</li>
<li>定常にも非定常にもなりうる : AR, ARMA</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org489a042">
<h3 id="org489a042">非定常過程の難しさ</h3>
<ul>
<li>性質を特徴付ける統計量が観測値から得られない
<ul>
<li>平均や分散などの基本的な統計量が時間によって変動する</li>
<li>1つの時系列から記述統計量の推測は一般にできない</li>

</ul></li>
<li>擬似相関の問題
<ul>
<li>2つの独立なランダムウォークは高い確率で&ldquo;相関&rdquo;を持つ
<ul>
<li>独立な時系列にも関わらず見掛けの相関が現れることがある</li>
<li><a href="http://tylervigen.com/spurious-correlations">http://tylervigen.com/spurious-correlations</a></li>

</ul></li>
<li><span style="color:gray;">因果推論などの潜伏変数とは異なる問題</span></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgabdbd9b">
<h3 id="orgabdbd9b">非定常過程の取り扱い</h3>
<ul>
<li>定常過程とみなせるように変換して分析を実行
<ul>
<li><p>
階差系列
</p>
<blockquote>
<p>
ランダムウォークは階差をとればホワイトノイズ(定常過程)となる
</p>
<div>
\begin{equation}
  X_{t}=X_{t-1}+\epsilon_{t}
  \quad\Rightarrow\quad
  Y_{t}=X_{t}-X_{t-1}=\epsilon_{t}
\end{equation}

</div>
</blockquote></li>
<li><p>
対数変換
</p>
<blockquote>
<p>
対数変換と階差で微小な比率の変動を取り出すことができる
</p>
<div>
\begin{equation}
  X_{t}=(1+\epsilon_{t})X_{t-1}
  \quad\Rightarrow\quad
  Y_{t}=\log(X_{t})-\log(X_{t-1})
  =\log(1+\epsilon_{t})
  \simeq\epsilon_{t}
\end{equation}

</div>
</blockquote></li>
<li><p>
トレンド成分+季節成分+変動成分への分解
</p>
<blockquote>
<p>
適当な仮説のもとに取り扱いやすい成分の和に分解する
</p>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org327c8a6">
<h2 id="org327c8a6">自己共分散・自己相関</h2>
<div class="outline-text-2" id="text-org327c8a6">
</div>
</section>
<section id="slide-org053659d">
<h3 id="org053659d">自己共分散・自己相関</h3>
<ul>
<li>確率過程\(X_{t}\)が <b>定常過程</b> の場合
<ul>
<li><p>
\(X_{t}\) と \(X_{t+h}\) の共分散は時点\(t\)によらずラグ\(h\)のみで定まる
</p>
<blockquote>
<p>
<b>自己共分散</b> (定常過程の性質よりラグは\(h\ge0\)を考えればよい)
</p>
<div>
\begin{equation}
  \mathrm{Cov}(X_{t},X_{t+h})
  =\gamma(h)
\end{equation}

</div>
</blockquote></li>
<li><p>
\(X_{t}\) と \(X_{t+h}\) の相関も\(t\)によらずラグ\(h\)のみで定まる
</p>
<blockquote>
<p>
<b>自己相関</b>
</p>
<div>
\begin{equation}
  \mathrm{Cov}(X_{t},X_{t+h})/\mathrm{Var}(X_{t})
  =\gamma(h)/\gamma(0)
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li>異なる時点間での観測データの従属関係を要約する最も基本的な統計量</li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org4d00e83">
<h3 id="org4d00e83">標本自己共分散・標本自己相関</h3>
<ul>
<li>観測データ \(X_1,\dotsc,X_{T}\) からの推定
<ul>
<li><p>
ラグ\(h\)の自己共分散の推定 : 標本自己共分散
</p>
<blockquote>
<div>
\begin{equation}
  \hat\gamma(h)
  =
  \frac{1}{T}\sum_{t=1}^{T-h}(X_{t}-\bar{X})(X_{t+h}-\bar{X})
\end{equation}

</div>
</blockquote>
<p>
\(\bar{X}=\frac{1}{T}\sum_{t=1}^TX_{t}\) は標本平均
</p></li>
<li><p>
ラグ\(h\)での自己相関の推定 : 標本自己相関
</p>
<blockquote>
<div>
\begin{equation}
  \hat\gamma(h)/\hat\gamma(0)
  =
  \frac{\sum_{t=1}^{T-h}(X_{t}-\bar{X})(X_{t+h}-\bar{X})}{\sum_{t=1}^T(X_{t}-\bar{X})^2}
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org248be27">
<h3 id="org248be27">数値例</h3>
<ul>
<li>同じモデルに従うパス(系列)の自己相関を比較する
<ul>
<li>自己回帰過程 (AR過程)</li>
<li>移動平均過程 (MA過程)</li>
<li>自己回帰移動平均過程 (ARMA過程)</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="orge33ef3f" class="figure">
<p><img src="figs/12_aracf.png" alt="12_aracf.png" />
</p>
<p><span class="figure-number">Figure 7: </span>AR過程の自己相関</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="orgbba0737" class="figure">
<p><img src="figs/12_maacf.png" alt="12_maacf.png" />
</p>
<p><span class="figure-number">Figure 8: </span>MA過程の自己相関</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="org46bba48" class="figure">
<p><img src="figs/12_armaacf.png" alt="12_armaacf.png" />
</p>
<p><span class="figure-number">Figure 9: </span>ARMA過程の自己相関</p>
</div>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org1e06e36" data-background="#fef4f4">
<h2 id="org1e06e36">実習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org4811e23" data-background="#fef4f4">
<h3 id="org4811e23">R : 自己相関・自己共分散の計算</h3>
<ul>
<li><p>
関数 <code>stats::acf()</code>
</p>
<div class="org-src-container">

<pre><code class="R" >acf(x, lag.max = NULL,
    type = c("correlation", "covariance", "partial"),
    plot = TRUE, na.action = na.fail, demean = TRUE, ...)
#' x: 時系列データ
#' lag.max: 計算するラグの最大値
#' type: 標準は相関, 共分散と偏相関を選ぶこともできる
#' plot: 描画するか否か
#' na.action: 欠損値の処理，標準は欠損を含むと計算しない
#' demean: 共分散の計算において平均を引くか否か
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org4317967" data-background="#fef4f4">
<h3 id="org4317967">R : 自己相関・自己共分散グラフの描画</h3>
<ul>
<li><p>
関数 ggfortify::autoplot()
</p>
<div class="org-src-container">

<pre><code class="R" >autoplot(object, colour = "#000000", linetype = "solid",
  conf.int = TRUE, conf.int.colour = "#0000FF", conf.int.linetype = "dashed",
  conf.int.fill = NULL, conf.int.alpha = 0.3, conf.int.value = 0.95,
  conf.int.type = "white", ...)
#' object: 関数acfの返値
#' 詳細は '?ggfortify::autoplot.acf()'を参照
</code></pre>
</div>
<ul>
<li><p>
<span style="color:green;">典型的な使い方</span>
</p>
<div class="org-src-container">

<pre><code class="R" >autoplot(acf(arima.sim(model = list(ar = c(0.8, -0.64),
                                    ma = c(-0.5)),
                       n = 200),
             plot = FALSE),
         main = "ACF of ARMA(2,1)")
</code></pre>
</div></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org7904273" data-background="#f4fef4">
<h3 id="org7904273">練習問題</h3>
<ul>
<li>以下の問に答えなさい
<ul>
<li>同じAR過程のモデルから生成した時系列の自己相関を比較しなさい<br />
(前の練習問題を利用すればよい)</li>
<li>MA過程についても同様な比較を行いなさい</li>
<li>ARMA過程についても同様な比較を行いなさい</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgd0dba33">
<h2 id="orgd0dba33">次回の内容</h2>
<ul>
<li>第1回 : 時系列の基本モデル</li>
<li><b>第2回 : モデルの推定と予測</b></li>

</ul>
<div class="slide-footer"><br></div>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,
overview: true,

transition: 'fade',
transitionSpeed: 'default',
spotlight: { size: 90, initialPresentationMode: false }, chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }, 84: function() { RevealSpotlight.toggleSpotlight() }, 81: function() { RevealSpotlight.togglePresentationMode()}},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'},
{ src: './reveal.js/plugin/spotlight/spotlight.js'}]

});
</script>
</body>
</html>
