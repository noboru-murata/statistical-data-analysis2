---
title: "統計データ解析"
subtitle: "第9講 実習"
date: "`r Sys.Date()`"
format:
    html: 
      toc: true
      html-math-method: katex
      self-contained: true
      grid: 
        margin-width: 350px
execute: 
  echo: true
  warning: false
reference-location: margin
citation-location: margin
tbl-cap-location: margin
fig-cap-location: margin
editor: visual
editor_options: 
  chunk_output_type: console
---

## 準備

以下で利用する共通パッケージを読み込む．

```{r}
library(conflicted) # 関数名の衝突を警告
conflicts_prefer(   # 優先的に使う関数を指定
    dplyr::filter(),
    dplyr::select(),
    dplyr::lag(),
    yardstick::spec(),
    yardstick::precision(),
    yardstick::recall(),
    )
library(tidyverse)  
library(MASS)
library(broom)      # 解析結果を tibble 形式に集約
library(gt)         # 表の作成
library(gtsummary)  # 分析結果の表の作成
library(ggfortify)  # biplot表示のため
library(tidymodels)
```

## 判別結果の評価

### 問題

前回と同様に東京の気候データの線形判別を行い，以下を確認しなさい．

-   9月と10月の気温と湿度のデータを抽出する．

    ``` r
    tw_data <- read_csv("data/tokyo_weather.csv") 
    tw_subset  <- tw_data |>
        filter(month %in% c(9,10)) |>
        select(temp, humid, month) |>
        mutate(month = as_factor(month)) # 月を因子化
    ```

-   全てデータを用いて線形判別関数を構成する．
-   構成した判別関数の評価を行う．
-   ROC曲線を描画し，AUCを求める．

```{r}

```

## 訓練・試験データによる評価

### 問題

Wine Quality Data Set を用いて，以下を確認しなさい．

-   8:2の比率で訓練データと試験データに分割する ．
-   訓練データを用いて線形・2次判別関数を構成する．
-   訓練データを用いて評価を行う．
-   試験データを用いて評価を行う．

```{r}

```

## LOO交叉検証法による予測誤差の評価

### 問題

データセット `MASS::biopsy` を用いて2次判別の分析を行いなさい．

-   全てのデータを用いて訓練誤差を評価する．
-   LOO交叉検証法を用いて予測誤差を評価する．

```{r}

```

## k-重交叉検証法による予測誤差の評価

### 問題

Wine Quality Data Set を用いて 線形判別と2次判別の分析を行いなさい．

-   LOO交叉検証法を用いて予測誤差を評価する．
-   k-重交叉検証法を用いて予測誤差を評価する．

```{r}

```
