<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>クラスター分析</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">クラスター分析</h1>
</div>
<div class="talk-subtitle">
    <p>階層的方法</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  2020.12.04</p>
</div>

</section>

<section>
<section id="slide-org6d57935">
<h2 id="org6d57935">講義の予定</h2>
<ul>
<li><b>第1日: クラスター分析と階層的クラスタリング</b></li>
<li>第2日: 非階層的クラスタリング</li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgbef624a">
<h2 id="orgbef624a">クラスター分析</h2>
<div class="outline-text-2" id="text-orgbef624a">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org96defec">
<h3 id="org96defec">クラスター分析とは</h3>
<ul>
<li>個体の間に隠れている <b>集まり=クラスター</b> を発見する方法</li>
<li>個体間の距離・類似度を定義:
<ul>
<li>同じクラスターに属する個体どうしは近い性質をもつ</li>
<li>異なるクラスターに属する個体どうしは異なる性質をもつ</li>

</ul></li>
<li>さらなるデータ解析やデータの可視化に利用</li>
<li>教師なし学習の代表的な手法の一つ</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org16c3521">
<h3 id="org16c3521">クラスター分析の考え方</h3>
<ul>
<li>階層的方法:
<ul>
<li>データ点およびクラスターの間に <b>距離</b> を定義</li>
<li>距離に基づいてグループ化:
<ul>
<li>近いものから順にクラスターを <b>凝集</b></li>
<li>近いもの同士が残るようにクラスターを <b>分割</b></li>

</ul></li>

</ul></li>
<li>非階層的方法:
<ul>
<li>クラスターの数を事前に指定</li>
<li>クラスターの <b>集まりの良さ</b> を評価する損失関数を定義</li>
<li>損失関数を最小化するようにクラスターを形成</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org9533d8f">
<h3 id="org9533d8f">事例</h3>
<p>
2次元の分布を考え
その中にグループを作成する方法を入れる
PCAで使ったデータが表示しやすい
</p>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orga738c94">
<h2 id="orga738c94">階層的クラスタリング</h2>
<div class="outline-text-2" id="text-orga738c94">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org2f5a5f0">
<h3 id="org2f5a5f0">凝集的方法の手続き</h3>
<ol>
<li>データ・クラスター間の距離を定義する
<ul>
<li>データ点とデータ点の距離</li>
<li>クラスターとクラスターの距離</li>
<li>(データ点とクラスターの距離はデータ1点をクラスターと考える)</li>

</ul></li>
<li>データ点および形成されているクラスターを対象にそれぞれの間の距離を求める</li>
<li>最も近い2つを統合し新たなクラスターを作成する <br />
(データ点とデータ点，データ点とクラスター，クラスターとクラスタのいずれの場合もあり得る)</li>
<li>クラスター数が目的の数になるまで2,3の手続きを繰り返す</li>

</ol>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orga37b694">
<h3 id="orga37b694">事例</h3>
<p>
上の例に対して
系統樹でどのように見せるか
実際の分析結果を見せるか
</p>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org0d71383">
<h2 id="org0d71383">データ間の距離</h2>
<div class="outline-text-2" id="text-org0d71383">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orge1a63cb">
<h3 id="orge1a63cb">データ間の距離</h3>
<ul>
<li><p>
データ: 変数の値を成分としてもつベクトル
</p>
<blockquote>
<div>
\begin{equation}
  \boldsymbol{x}_{i}=(x_{i1},\dotsc,x_{ip})^{\top},
  \boldsymbol{x}_{j}=(x_{j1},\dotsc,x_{jp})^{\top}\in\mathbb{R}^p
\end{equation}

</div>
</blockquote></li>
<li>距離: \(d(\boldsymbol{x}_{i},\boldsymbol{x}_{j})\)</li>
<li>代表的なデータ間の距離:
<ul>
<li>ユークリッド距離 (Euclidean distance)</li>
<li>ミンコフスキー距離 (Minkowski distance)</li>
<li>マンハッタン距離 (Manhattan distance)</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org2c6ec52">
<h3 id="org2c6ec52">ユークリッド距離</h3>
<ul>
<li>最も一般的な距離</li>
<li><p>
各成分の差の2乗和の平方根 (2ノルム)
</p>
<blockquote>
<div>
\begin{equation*}
  d(\boldsymbol{x}_{i},\boldsymbol{x}_{j})
  =\sqrt{(x_{i1}-x_{j1})^{2}+\dotsb+(x_{ip}-x_{jp})^{2}}
\end{equation*}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf9fd29f">
<h3 id="orgf9fd29f">ミンコフスキー距離</h3>
<ul>
<li>ユークリッド距離を \(q\) 乗に一般化した距離</li>
<li><p>
各成分の差の \(q\) 乗和の \(q\) 乗根(\(q\) ノルム)
</p>
<blockquote>
<div>
\begin{equation*}
  d(\boldsymbol{x}_{i},\boldsymbol{x}_{j})
  =\bigl\{|x_{i1}-x_{j1}|^{q}+\dotsb+|x_{ip}-x_{jp}|^{q}\bigr\}^{1/q}
\end{equation*}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org0ed2712">
<h3 id="org0ed2712">マンハッタン距離</h3>
<ul>
<li>\(q=1\) のミンコフスキー距離</li>
<li><p>
格子状に引かれた路に沿って移動するときの距離
</p>
<blockquote>
<div>
\begin{equation*}
  d(\boldsymbol{x}_{i},\boldsymbol{x}_{j})
  =|x_{i1}-x_{j1}|+\dotsb+|x_{ip}-x_{jp}|
\end{equation*}

</div>
</blockquote></li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgac895b2">
<h2 id="orgac895b2">演習</h2>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org55a316a">
<h2 id="org55a316a">実習</h2>
<p>
距離を比較させる問題を考える
ユークリッド距離とマンハッタン距離でのデータ間の違い
shepard plotを考えさせる．
</p>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org6140e64">
<h2 id="org6140e64">クラスタ間の距離</h2>
<div class="outline-text-2" id="text-org6140e64">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgd079aa9">
<h3 id="orgd079aa9">クラスター間の距離</h3>
<ul>
<li>データ点同士の距離をどのように使うかで定義
<ul>
<li>データ点の距離から陽に定義する方法</li>
<li>クラスターを統合したときに成り立つクラスター間の距離の関係を用いて再帰的に定義する方法</li>

</ul></li>
<li><p>
クラスター: いくつかのデータ点からなる集合
</p>
<blockquote>
<div>
\begin{equation*}
  C_{a}=\left\{\boldsymbol{x}_{i}|i\in\Lambda_{a}\right\},\quad
  C_{b}=\left\{\boldsymbol{x}_{j}|j\in\Lambda_{b}\right\}
\end{equation*}

</div>
</blockquote></li>
<li>2つのクラスター間の距離: \(D(C_{a},C_{b})\)</li>
<li>代表的なクラスター間の距離
<ul>
<li>最短距離法 (単連結法; single linkage method)</li>
<li>最長距離法 (完全連結法; complete linkage method)</li>
<li>群平均法 (average linkage method)</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org7566760">
<h3 id="org7566760">最短距離法</h3>
<ul>
<li><p>
最も近い対象間の距離を用いる方法:
</p>
<blockquote>
<div>
\begin{equation}
  D(C_{a},C_{b})
  =\min_{\boldsymbol{x}_{i}\in C_{a},\;\boldsymbol{x}_{j}\in C_{b}} d(\boldsymbol{x}_{i},\boldsymbol{x}_{j})
\end{equation}

</div>
</blockquote></li>
<li><p>
統合前後のクラスター間の関係:
</p>
<blockquote>
<div>
\begin{equation}
  D(C_{a}+ C_{b}, C_{c})
  =\min\bigl\{D(C_{a},C_{c}), D(C_{b},C_{c})\bigr\}
  % =\min\left\{D(C_{a},C_{c}), D(C_{b},C_{c})\right\}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org54870d2">
<h3 id="org54870d2">最長距離法</h3>
<ul>
<li><p>
最も遠い対象間の距離を用いる方法:
</p>
<blockquote>
<div>
\begin{equation}
  D(C_{a},C_{b})
  =\max_{\boldsymbol{x}_{i}\in C_{a},\;\boldsymbol{x}_{j}\in C_{b}} d(\boldsymbol{x}_{i},\boldsymbol{x}_{j})
\end{equation}

</div>
</blockquote></li>
<li><p>
統合前後のクラスター間の関係:
</p>
<blockquote>
<div>
\begin{equation}
  D(C_{a}+ C_{b}, C_{c})
  =\max\bigl\{D(C_{a},C_{c}), D(C_{b},C_{c})\bigr\}
  % =\max\left\{D(C_{a},C_{c}), D(C_{b},C_{c})\right\}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org86afa62">
<h3 id="org86afa62">群平均法</h3>
<ul>
<li><p>
全ての対象間の平均距離を用いる方法:
</p>
<blockquote>
<div>
\begin{equation}
  D(C_{a},C_{b})
  =\frac{1}{|C_{a}||C_{b}|}
  \sum_{\boldsymbol{x}_{i}\in C_{a},\;\boldsymbol{x}_{j}\in C_{b}} d(\boldsymbol{x}_{i},\boldsymbol{x}_{j})
\end{equation}

</div>
</blockquote>
<p>
ただし \(|C_{a}|\), \(|C_{b}|\) はクラスター内の要素の数を表す
</p></li>
<li><p>
統合前後のクラスター間の関係:
</p>
<blockquote>
<div>
\begin{equation}
  D(C_{a}+ C_{b}, C_{c})
  =\frac{|C_{a}|D(C_{a},C_{c})+|C_{b}|D(C_{b},C_{c})}{|C_{a}|+|C_{b}|}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org1b95bf5">
<h3 id="org1b95bf5">距離計算に関する注意</h3>
<ul>
<li>データの性質に応じて距離は適宜使い分ける
<ul>
<li>データ間の距離の選択</li>
<li>クラスター間の距離の選択</li>

</ul></li>
<li>変数の正規化は必要に応じて行う
<ul>
<li>物理的な意味合いを積極的に利用する場合はそのまま</li>
<li>単位の取り方などによる分析の不確定性を避ける場合は平均0，分散1に正規化</li>

</ul></li>
<li>データの性質を鑑みて適切に前処理</li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgf251a75">
<h2 id="orgf251a75">演習</h2>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org3892c10">
<h2 id="org3892c10">実習</h2>
<div class="outline-text-2" id="text-org3892c10">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org0dd8a97" data-background="#EEEEFF">
<h3 id="org0dd8a97">演習: 階層的クラスタリング</h3>
<ul>
<li><a href="./code/11-hclust.r">11-hclust.r</a> を確認してみよう</li>

</ul>

<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org9b9cce3">
<h2 id="org9b9cce3">講義の予定</h2>
<ul>
<li>第1日: クラスター分析と階層的クラスタリング</li>
<li><b>第2日: 非階層的クラスタリング</b></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,

overview: true,

transition: 'fade',
transitionSpeed: 'default',
chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'}]

});
</script>
</body>
</html>
